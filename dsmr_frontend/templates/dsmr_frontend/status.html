{% extends "dsmr_frontend/base.html" %}
{% load humanize %} 
{% load static %} 
{% load i18n %}
{% load model_meta_info %}

{% block title %}{% trans "Status" %}{% endblock %}
{% block header %}{% trans "Status" %} &nbsp; <i class="fa fa-heartbeat"></i>{% endblock %}

{% block content %}
<!-- Main content -->
<section class="content">
{% if not capabilities.any %}
    <div class="alert alert-danger" role="alert">
        <span class="fa fa-exclamation fa-2x"></span> {% blocktrans %}No data found. Please make sure the datalogger is up and running and the backend process is running as well.{% endblocktrans %}
    </div>
{% endif %}

    <div class="row">
        <div class="col-md-12">
            <div class="panel">
                <header class="panel-heading">
                    {% trans "Readings" %} <br />
                    <small>{% blocktrans %}Number of times data read from your meter. Should be updated every 15 seconds.{% endblocktrans %}</small>
                </header>
                <div class="panel-body">
                    <table class="table table-condensed">
                        <tr>
                            <td class="col-md-6">{% trans "Latest reading" %}</td>
                            <td class="col-md-6">{% if latest_reading %}{{ latest_reading.timestamp|naturaltime }}{% endif %}</td>
                        </tr>
                        <tr>
                            <td class="col-md-6">{% trans "First reading" %}</td>
                            <td class="col-md-6">{% if first_reading %}<span class="badge bg-navy">{{ first_reading.timestamp|default:'-' }}</span>{% endif %}</td>
                        </tr>
                        <tr>
                            <td>{% trans "Total reading count" %}</td>
                            <td><span class="badge bg-navy">{{ total_reading_count|intcomma }}</span></td>
                        </tr>
                    </table>
                </div><!-- /.panel-body -->
            </div><!-- /.panel -->
        </div><!-- /.col -->
    </div><!-- /.row -->
 
    <div class="row">
        <div class="col-md-12">
            <div class="panel">
                <header class="panel-heading">
                    {% trans "Background" %}<br />
                    <small>{% blocktrans %}Most data is processed with a small delay, but should take no longer than a minute to update. Gas consumption however, is only updated once a hour.{% endblocktrans %}</small>
                </header>
                <div class="panel-body">
                    <table class="table table-condensed">
                        <tr>
                            <td class="col-md-6">{% trans "Unprocessed readings" %}</td>
                            <td class="col-md-6">{{ unprocessed_readings|default:'-' }}</td>
                        </tr>
                        {% if latest_ec %}
                        <tr>
                            <td class="col-md-6">{% trans "Latest electricity consumption tracked" %}</td>
                            <td class="col-md-6">{{ latest_ec.read_at|naturaltime }}</td>
                        </tr>
                        {% endif %}
                        {% if latest_gc %}
                        <tr>
                            <td class="col-md-6">{% trans "Latest gas consumption tracked" %}</td>
                            <td class="col-md-6">{{ latest_gc.read_at|naturaltime }}</td>
                        </tr>
                        {% endif %}
                    </table>
                </div><!-- /.panel-body -->
            </div><!-- /.panel -->
        </div><!-- /.col -->
    </div><!-- /.row -->

    <div class="row">
        <div class="col-md-12">
            <div class="panel">
                <header class="panel-heading">
                    {% trans "Data availability" %} <br />
                    <small>{% blocktrans %}Based on readings until this moment{% endblocktrans %}</small>
                </header>
                <div class="panel-body">
                    <table class="table table-condensed">
                        <tr>
                            <th class="col-md-6">{% trans "Data type" %}</th>
                            <th class="col-md-6">{% trans "Read" %}</th>
                        </tr>
                        <tr>
                            <td><span class="badge bg-red">&nbsp;<i class="fa fa-bolt fa-lg"></i>&nbsp;</span> &nbsp; {% trans "Electricity usage" %}</td>
                            <td><i class="fa fa-{{ capabilities.electricity|yesno:'check-square-o,close' }} fa-lg"></td>
                        </tr>
                        <tr>
                            <td><span class="badge bg-green">&nbsp;<i class="fa fa-bolt fa-lg"></i>&nbsp;</span> &nbsp; {% trans "Electricity return" %}</td>
                            <td><i class="fa fa-{{ capabilities.electricity_returned|yesno:'check-square-o,close' }} fa-lg"></td>
                        </tr>
                        <tr>
                            <td><span class="badge bg-orange"><i class="fa fa-fire fa-lg"></i></span> &nbsp; {% trans "Gas usage" %}</td>
                            <td><i class="fa fa-{{ capabilities.gas|yesno:'check-square-o,close' }} fa-lg"></td>
                        </tr>
                    </table>
                </div><!-- /.panel-body -->
            </div><!-- /.panel -->
        </div><!-- /.col -->
    </div><!-- /.row -->

</section><!-- /.content -->
{% endblock %}
